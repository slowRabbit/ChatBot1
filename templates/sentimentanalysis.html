<!doctype html>

<title> ChatBot SentimentAnalyzer </title>
<head>
<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>

<script>
    function loadFactorDataGraph()
    {
        var req = new XMLHttpRequest()
        req.onreadystatechange = function()
        {
            if (req.readyState == 4)
            {
                if (req.status != 200)
                {
                    //error handling code here
                    
                }
                else
                {
                   // var dd = JSON.parse(req.responseText)
                   // document.getElementById('myDiv').innerHTML = response.username
                   
                   var data = req.responseText
                   console.log("response from server recieved " + data)
                   document.getElementById("graph_factor").src="/getUpdatedFactorList";
                }
            }
        }
    
        req.open('GET', '/getUpdatedFactorList', true)
        //req.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
    
        req.send()
        
        return false
    }
    
    function checkIfUpdated()
    {
       var req = new XMLHttpRequest()
        req.onreadystatechange = function()
        {
            if (req.readyState == 4)
            {
                if (req.status != 200)
                {
                    //error handling code here
                    
                }
                else
                {
                   // var dd = JSON.parse(req.responseText)
                   // document.getElementById('myDiv').innerHTML = response.username
                   
                   var data = req.responseText
                   console.log("isupdated response from server recieved " + data)
                   //document.getElementById("graph_factor").src="/getUpdatedFactorList";
                }
            }
        }
    
        req.open('GET', '/checkUpdated', true)
        //req.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
    
        req.send()
        
        return false
    }
    
    $(document).ready(function() {
  
          factor_graph_updater()
    });
    
    function factor_graph_updater() {
    
        console.log("graph updated ")
        document.getElementById("graph_factor").src="/getUpdatedFactorList";
        setTimeout(factor_graph_updater, 5000);
    
        };
    
    
</script>



<style>
div.graph{
    margin-top: 30px;
    margin-bottom: 30px;
}

div.heading {
    margin-top: 30px;
    margin-bottom: 30px;
    color : white;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 45px;
}


</style>

</head>

<body class="body" style="background-color: #424242;">
      
      <!--
      <button type="button" onclick="loadFactorDataGraph()" > Update </Button>
      
      <button type="button" onclick="worker()" > CheckUpdated </Button>
      -->
      <div class="heading" align="center">
      Realtime chat sentiment analysis
	  </div>
	  
	  <div class="graph" align="center" >
    	  <!--
    	  <input type="button" value="Submit" onclick="return loadFactorDataGraph()">
			<embed type="image/svg+xml" src={{graph_data_score|safe}} style='max-width:800px;'/>
			
			<embed type="image/svg+xml" src={{graph_data_magnitude|safe}} style='max-width:800px'/>
			-->
			<embed id="graph_factor" type="image/svg+xml" src="/getUpdatedFactorList" style='width:45%;height:70vh'/>
			
	  </div>
	  
	  

</body>